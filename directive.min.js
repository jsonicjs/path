!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JsonicDirective=e()}}((function(){var e={};Object.defineProperty(e,"__esModule",{value:!0}),e.Directive=void 0;const n=(e,n)=>{let l,t=("string"==typeof n.rules?n.rules.split(/\s*,\s*/):n.rules||[]).filter(e=>""!==e),o=n.name,i=n.open,r=n.close;if("string"==typeof n.action){let t=n.action;l=n=>n.node=e.util.prop(e.options,t)}else l=n.action;let s={},u="#D_open_"+o,c="#D_close_"+o,d=e.fixed(i),f=null==r?null:e.fixed(r);if(null!=d)throw new Error("Directive open token already in use: "+i);s[u]=i,null==f&&null!=r&&(s[c]=r),e.options({fixed:{token:s},error:{[o+"_close"]:null==r?null:"directive "+o+' close "'+r+'" without open "'+i+'"'},hint:{[o+"_close"]:null==r?null:`\nThe ${o} directive must start with the characters "${i}" and end\nwith the characters "${r}". The end characters "${r}" may not\nappear without the start characters "${i}" appearing first:\n"${i}...${r}".\n`}});let a=e.token.CA;d=e.fixed(i),f=null==r?null:e.fixed(r),t.forEach(n=>{e.rule(n,e=>(e.open({s:[d],p:o,n:{dr:1}}),null!=r&&(e.open([{s:[f],c:{n:{dr:0}},e:(e,n)=>n.t0.bad(o+"_close")},{s:[f],b:1}]),e.close({s:[f],b:1})),e))}),e.rule(o,e=>e.clear().bo(e=>{e.node={}}).open([{p:"val",n:null==r?{}:{pk:-1,il:0}}]).bc((function(e,n){let t=l.call(this,e,n);if(null==t?void 0:t.isToken)return t})).close(null!=r?[{s:[f]},{s:[a,f]}]:[]))};return e.Directive=n,n.defaults={rules:"val,pair,elem"},e}));